{"primaryContentSections":[{"kind":"declarations","declarations":[{"tokens":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"PersistenceLayer"}],"languages":["swift"],"platforms":["iOS"]}]},{"kind":"content","content":[{"anchor":"overview","level":2,"type":"heading","text":"Overview"},{"style":"note","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Klemens Muthmann"}]}],"type":"aside","name":"Author"},{"style":"note","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"6.2.0"}]}],"type":"aside","name":"Version"},{"style":"note","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"1.0.0"}]}],"type":"aside","name":"Since"},{"style":"note","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Most methods implemented by this class throw internal CoreData errors. This usually indicates something to be seriously wrong with the device executing the method and are almost never recoverable. Errors from the file system are rethrown on reading and writing sensor values. Those are mostly not recoverable as well. Another common error is an inconstent state of the measurement worked on, such as locations with non strongly monotonically increasing timestamps."}]}],"type":"aside","name":"Throws"}]}],"schemaVersion":{"major":0,"minor":2,"patch":0},"sections":[],"variants":[{"paths":["\/documentation\/datacapturing\/persistencelayer"],"traits":[{"interfaceLanguage":"swift"}]}],"identifier":{"url":"doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer","interfaceLanguage":"swift"},"abstract":[{"type":"text","text":"An instance of an object of this class is a wrapper around the CoreData data storage used by the capturing service. It allows CRUD operations on measurements, geo locations and sensor values."}],"kind":"symbol","metadata":{"fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"PersistenceLayer"}],"title":"PersistenceLayer","roleHeading":"Class","role":"symbol","symbolKind":"class","externalID":"s:13DataCapturing16PersistenceLayerC","modules":[{"name":"DataCapturing"}],"navigatorTitle":[{"kind":"identifier","text":"PersistenceLayer"}]},"hierarchy":{"paths":[["doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing"]]},"topicSections":[{"title":"Initializers","identifiers":["doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/init(onManager:withDistanceCalculator:)"]},{"title":"Instance Methods","identifiers":["doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/countGeoLocations(forMeasurement:)","doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/countMeasurements()","doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/createEvent(of:withValue:timestamp:parent:)","doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/delete(event:)","doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/delete(measurement:)","doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/load(measurementIdentifiedBy:)","doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/loadClean(track:)","doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/loadEvents(typed:forMeasurement:)","doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/loadMeasurements()","doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/loadSynchronizableMeasurements()","doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/save(measurement:)"]},{"title":"Type Methods","identifiers":["doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/collectGeoLocations(from:)","doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/extractIdentifiers(from:)","doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/traverseTracks(ofMeasurement:call:)"]}],"references":{"doc://org.cocoapods.DataCapturing/documentation/DataCapturing/PersistenceLayer/createEvent(of:withValue:timestamp:parent:)":{"role":"symbol","title":"createEvent(of:withValue:timestamp:parent:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"createEvent"},{"kind":"text","text":"("},{"kind":"externalParam","text":"of"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"EventType","preciseIdentifier":"s:13DataCapturing9EventTypeO"},{"kind":"text","text":", "},{"kind":"externalParam","text":"withValue"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"String","preciseIdentifier":"s:SS"},{"kind":"text","text":"?, "},{"kind":"externalParam","text":"timestamp"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"Date","preciseIdentifier":"s:10Foundation4DateV"},{"kind":"text","text":", "},{"kind":"externalParam","text":"parent"},{"kind":"text","text":": "},{"kind":"keyword","text":"inout"},{"kind":"text","text":" "},{"kind":"typeIdentifier","text":"Measurement","preciseIdentifier":"s:13DataCapturing11MeasurementC"},{"kind":"text","text":") "},{"kind":"keyword","text":"throws"},{"kind":"text","text":" -> "},{"kind":"typeIdentifier","text":"Event","preciseIdentifier":"s:13DataCapturing5EventC"}],"abstract":[{"type":"text","text":"Creates a new "},{"type":"codeVoice","code":"Event"},{"type":"text","text":" at the current time."}],"identifier":"doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/createEvent(of:withValue:timestamp:parent:)","kind":"symbol","type":"topic","url":"\/documentation\/datacapturing\/persistencelayer\/createevent(of:withvalue:timestamp:parent:)"},"doc://org.cocoapods.DataCapturing/documentation/DataCapturing/PersistenceLayer/loadMeasurements()":{"role":"symbol","title":"loadMeasurements()","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"loadMeasurements"},{"kind":"text","text":"() "},{"kind":"keyword","text":"throws"},{"kind":"text","text":" -> ["},{"kind":"typeIdentifier","text":"Measurement","preciseIdentifier":"s:13DataCapturing11MeasurementC"},{"kind":"text","text":"]"}],"abstract":[{"type":"text","text":"Loads all the measurements from the data storage."}],"identifier":"doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/loadMeasurements()","kind":"symbol","type":"topic","url":"\/documentation\/datacapturing\/persistencelayer\/loadmeasurements()"},"doc://org.cocoapods.DataCapturing/documentation/DataCapturing/PersistenceLayer/init(onManager:withDistanceCalculator:)":{"role":"symbol","title":"init(onManager:withDistanceCalculator:)","fragments":[{"kind":"identifier","text":"init"},{"kind":"text","text":"("},{"kind":"externalParam","text":"onManager"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"CoreDataManager","preciseIdentifier":"s:13DataCapturing04CoreA7ManagerC"},{"kind":"text","text":", "},{"kind":"externalParam","text":"withDistanceCalculator"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"DistanceCalculationStrategy","preciseIdentifier":"s:13DataCapturing27DistanceCalculationStrategyP"},{"kind":"text","text":")"}],"abstract":[{"type":"text","text":"Public constructor usable by external callers."}],"identifier":"doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/init(onManager:withDistanceCalculator:)","kind":"symbol","type":"topic","url":"\/documentation\/datacapturing\/persistencelayer\/init(onmanager:withdistancecalculator:)"},"doc://org.cocoapods.DataCapturing/documentation/DataCapturing/PersistenceLayer/countGeoLocations(forMeasurement:)":{"role":"symbol","title":"countGeoLocations(forMeasurement:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"countGeoLocations"},{"kind":"text","text":"("},{"kind":"externalParam","text":"forMeasurement"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"Measurement","preciseIdentifier":"s:13DataCapturing11MeasurementC"},{"kind":"text","text":") "},{"kind":"keyword","text":"throws"},{"kind":"text","text":" -> "},{"kind":"typeIdentifier","text":"Int","preciseIdentifier":"s:Si"}],"abstract":[{"type":"text","text":"Counts the number of geo locations from a certain measurement."}],"identifier":"doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/countGeoLocations(forMeasurement:)","kind":"symbol","type":"topic","url":"\/documentation\/datacapturing\/persistencelayer\/countgeolocations(formeasurement:)"},"doc://org.cocoapods.DataCapturing/documentation/DataCapturing/PersistenceLayer/delete(measurement:)":{"role":"symbol","title":"delete(measurement:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"delete"},{"kind":"text","text":"("},{"kind":"externalParam","text":"measurement"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"Int64","preciseIdentifier":"s:s5Int64V"},{"kind":"text","text":") "},{"kind":"keyword","text":"throws"}],"abstract":[{"type":"text","text":"Deletes the measurement from the data storag."}],"identifier":"doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/delete(measurement:)","kind":"symbol","type":"topic","url":"\/documentation\/datacapturing\/persistencelayer\/delete(measurement:)"},"doc://org.cocoapods.DataCapturing/documentation/DataCapturing/PersistenceLayer/load(measurementIdentifiedBy:)":{"role":"symbol","title":"load(measurementIdentifiedBy:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"load"},{"kind":"text","text":"("},{"kind":"externalParam","text":"measurementIdentifiedBy"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"Int64","preciseIdentifier":"s:s5Int64V"},{"kind":"text","text":") "},{"kind":"keyword","text":"throws"},{"kind":"text","text":" -> "},{"kind":"typeIdentifier","text":"Measurement","preciseIdentifier":"s:13DataCapturing11MeasurementC"}],"abstract":[{"type":"text","text":"Loads the data belonging to the provided "},{"type":"codeVoice","code":"measurement"},{"type":"text","text":" in the background an calls "},{"type":"codeVoice","code":"onFinishedCall"},{"type":"text","text":" with the data storage representation of that "},{"type":"codeVoice","code":"measurement"},{"type":"text","text":". Using that represenation is not thread safe. Do not use it outside of the handler."}],"identifier":"doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/load(measurementIdentifiedBy:)","kind":"symbol","type":"topic","url":"\/documentation\/datacapturing\/persistencelayer\/load(measurementidentifiedby:)"},"doc://org.cocoapods.DataCapturing/documentation/DataCapturing/PersistenceLayer/delete(event:)":{"role":"symbol","title":"delete(event:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"delete"},{"kind":"text","text":"("},{"kind":"externalParam","text":"event"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"Event","preciseIdentifier":"s:13DataCapturing5EventC"},{"kind":"text","text":") "},{"kind":"keyword","text":"throws"}],"abstract":[{"type":"text","text":"Deletes one event from the database."}],"identifier":"doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/delete(event:)","kind":"symbol","type":"topic","url":"\/documentation\/datacapturing\/persistencelayer\/delete(event:)"},"doc://org.cocoapods.DataCapturing/documentation/DataCapturing/PersistenceLayer/extractIdentifiers(from:)":{"role":"symbol","title":"extractIdentifiers(from:)","fragments":[{"kind":"keyword","text":"static"},{"kind":"text","text":" "},{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"extractIdentifiers"},{"kind":"text","text":"("},{"kind":"externalParam","text":"from"},{"kind":"text","text":": ["},{"kind":"typeIdentifier","text":"Measurement","preciseIdentifier":"s:13DataCapturing11MeasurementC"},{"kind":"text","text":"]) -> ["},{"kind":"typeIdentifier","text":"Int64","preciseIdentifier":"s:s5Int64V"},{"kind":"text","text":"]"}],"abstract":[{"type":"text","text":"Transforms a list of "},{"type":"codeVoice","code":"Measurement"},{"type":"text","text":" objects to a list containing the identifiers."}],"identifier":"doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/extractIdentifiers(from:)","kind":"symbol","type":"topic","url":"\/documentation\/datacapturing\/persistencelayer\/extractidentifiers(from:)"},"doc://org.cocoapods.DataCapturing/documentation/DataCapturing/PersistenceLayer/loadClean(track:)":{"role":"symbol","title":"loadClean(track:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"loadClean"},{"kind":"text","text":"("},{"kind":"externalParam","text":"track"},{"kind":"text","text":": "},{"kind":"keyword","text":"inout"},{"kind":"text","text":" "},{"kind":"typeIdentifier","text":"Track","preciseIdentifier":"s:13DataCapturing5TrackC"},{"kind":"text","text":") "},{"kind":"keyword","text":"throws"},{"kind":"text","text":" -> ["},{"kind":"typeIdentifier","text":"GeoLocation","preciseIdentifier":"s:13DataCapturing11GeoLocationC"},{"kind":"text","text":"]"}],"abstract":[{"type":"text","text":"Provides only the valid locations within a cleaned geo location track. This excludes locations occuring because of geo location jitter and pauses."}],"identifier":"doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/loadClean(track:)","kind":"symbol","type":"topic","url":"\/documentation\/datacapturing\/persistencelayer\/loadclean(track:)"},"doc://org.cocoapods.DataCapturing/documentation/DataCapturing/PersistenceLayer/countMeasurements()":{"role":"symbol","title":"countMeasurements()","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"countMeasurements"},{"kind":"text","text":"() "},{"kind":"keyword","text":"throws"},{"kind":"text","text":" -> "},{"kind":"typeIdentifier","text":"Int","preciseIdentifier":"s:Si"}],"abstract":[{"type":"text","text":"Counts the amount of measurements currently stored in the data store."}],"identifier":"doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/countMeasurements()","kind":"symbol","type":"topic","url":"\/documentation\/datacapturing\/persistencelayer\/countmeasurements()"},"doc://org.cocoapods.DataCapturing/documentation/DataCapturing/PersistenceLayer/loadEvents(typed:forMeasurement:)":{"role":"symbol","title":"loadEvents(typed:forMeasurement:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"loadEvents"},{"kind":"text","text":"("},{"kind":"externalParam","text":"typed"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"EventType","preciseIdentifier":"s:13DataCapturing9EventTypeO"},{"kind":"text","text":", "},{"kind":"externalParam","text":"forMeasurement"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"Measurement","preciseIdentifier":"s:13DataCapturing11MeasurementC"},{"kind":"text","text":") "},{"kind":"keyword","text":"throws"},{"kind":"text","text":" -> ["},{"kind":"typeIdentifier","text":"Event","preciseIdentifier":"s:13DataCapturing5EventC"},{"kind":"text","text":"]"}],"abstract":[{"type":"text","text":"Retrieves the list of all events of a certain "},{"type":"codeVoice","code":"EventType"},{"type":"text","text":" belonging to a "},{"type":"codeVoice","code":"MeasurementMO"},{"type":"text","text":" from the database."}],"identifier":"doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/loadEvents(typed:forMeasurement:)","kind":"symbol","type":"topic","url":"\/documentation\/datacapturing\/persistencelayer\/loadevents(typed:formeasurement:)"},"doc://org.cocoapods.DataCapturing/documentation/DataCapturing/PersistenceLayer/collectGeoLocations(from:)":{"role":"symbol","title":"collectGeoLocations(from:)","fragments":[{"kind":"keyword","text":"static"},{"kind":"text","text":" "},{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"collectGeoLocations"},{"kind":"text","text":"("},{"kind":"externalParam","text":"from"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"Measurement","preciseIdentifier":"s:13DataCapturing11MeasurementC"},{"kind":"text","text":") -> ["},{"kind":"typeIdentifier","text":"GeoLocation","preciseIdentifier":"s:13DataCapturing11GeoLocationC"},{"kind":"text","text":"]"}],"abstract":[{"type":"text","text":"Collects all geo locations from all tracks of a measurement and merges them to a single array."}],"identifier":"doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/collectGeoLocations(from:)","kind":"symbol","type":"topic","url":"\/documentation\/datacapturing\/persistencelayer\/collectgeolocations(from:)"},"doc://org.cocoapods.DataCapturing/documentation/DataCapturing":{"role":"collection","title":"DataCapturing","abstract":[],"identifier":"doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing","kind":"symbol","type":"topic","url":"\/documentation\/datacapturing"},"doc://org.cocoapods.DataCapturing/documentation/DataCapturing/PersistenceLayer/save(measurement:)":{"role":"symbol","title":"save(measurement:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"save"},{"kind":"text","text":"("},{"kind":"externalParam","text":"measurement"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"Measurement","preciseIdentifier":"s:13DataCapturing11MeasurementC"},{"kind":"text","text":") "},{"kind":"keyword","text":"throws"},{"kind":"text","text":" -> "},{"kind":"typeIdentifier","text":"Measurement","preciseIdentifier":"s:13DataCapturing11MeasurementC"}],"abstract":[{"type":"text","text":"Save the provided "},{"type":"codeVoice","code":"Measurement"},{"type":"text","text":" via CoreData"}],"identifier":"doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/save(measurement:)","kind":"symbol","type":"topic","url":"\/documentation\/datacapturing\/persistencelayer\/save(measurement:)"},"doc://org.cocoapods.DataCapturing/documentation/DataCapturing/PersistenceLayer/traverseTracks(ofMeasurement:call:)":{"role":"symbol","title":"traverseTracks(ofMeasurement:call:)","fragments":[{"kind":"keyword","text":"static"},{"kind":"text","text":" "},{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"traverseTracks"},{"kind":"text","text":"("},{"kind":"externalParam","text":"ofMeasurement"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"Measurement","preciseIdentifier":"s:13DataCapturing11MeasurementC"},{"kind":"text","text":", "},{"kind":"externalParam","text":"call"},{"kind":"text","text":": ("},{"kind":"typeIdentifier","text":"Track","preciseIdentifier":"s:13DataCapturing5TrackC"},{"kind":"text","text":", "},{"kind":"typeIdentifier","text":"GeoLocation","preciseIdentifier":"s:13DataCapturing11GeoLocationC"},{"kind":"text","text":") -> "},{"kind":"typeIdentifier","text":"Void","preciseIdentifier":"s:s4Voida"},{"kind":"text","text":")"}],"abstract":[{"type":"text","text":"Traverses all tracks captured as part of a measurement and provides each track and geo location to a callback."}],"identifier":"doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/traverseTracks(ofMeasurement:call:)","kind":"symbol","type":"topic","url":"\/documentation\/datacapturing\/persistencelayer\/traversetracks(ofmeasurement:call:)"},"doc://org.cocoapods.DataCapturing/documentation/DataCapturing/PersistenceLayer":{"role":"symbol","title":"PersistenceLayer","fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"PersistenceLayer"}],"abstract":[{"type":"text","text":"An instance of an object of this class is a wrapper around the CoreData data storage used by the capturing service. It allows CRUD operations on measurements, geo locations and sensor values."}],"identifier":"doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"PersistenceLayer"}],"url":"\/documentation\/datacapturing\/persistencelayer"},"doc://org.cocoapods.DataCapturing/documentation/DataCapturing/PersistenceLayer/loadSynchronizableMeasurements()":{"role":"symbol","title":"loadSynchronizableMeasurements()","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"loadSynchronizableMeasurements"},{"kind":"text","text":"() "},{"kind":"keyword","text":"throws"},{"kind":"text","text":" -> ["},{"kind":"typeIdentifier","text":"Measurement","preciseIdentifier":"s:13DataCapturing11MeasurementC"},{"kind":"text","text":"]"}],"abstract":[{"type":"text","text":"Loads only those measurements that have not been synchronized to a Cyface database yet and that are synchronizable at the moment."}],"identifier":"doc:\/\/org.cocoapods.DataCapturing\/documentation\/DataCapturing\/PersistenceLayer\/loadSynchronizableMeasurements()","kind":"symbol","type":"topic","url":"\/documentation\/datacapturing\/persistencelayer\/loadsynchronizablemeasurements()"}}}